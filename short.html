<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Berg Balance Skala (BBS)</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; font-size: 16px; max-width: 1000px; }
    .question-block { margin-bottom: 1.5rem; }
    .question { font-weight: bold; margin-bottom: 0.5rem; }
    select, input[type="number"] { width: 100%; padding: 8px; font-size: 16px; margin-bottom: 1rem; }
    button { margin-top: 20px; padding: 10px 15px; font-size: 16px; }
    #scoreDisplay, #result { margin-top: 2rem; font-weight: bold; white-space: pre-line; }
    #normInfo { margin-top: 1rem; font-size: 0.9em; color: #333; }
    #normBlock { display: none; margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>Berg Balance Skala (BBS)</h1>
  <p>Einer der am umfassendsten untersuchten Assessments fÃ¼r das Gleichgewicht mit guter Psychometrischer GÃ¼te und ReliabilitÃ¤t. Geriatrie, MS, CVI, Parkinson </p>
  <p> Auch in einer verkÃ¼rzten Version mÃ¶glich. Diese ist schneller, benÃ¶tigt weniger Material ist aber weniger gut untersucht und bietet keine Norm oder Cut-Off Werte </p>
  <p> Im Cenplex Behandlungsplan als <strong> Messung </strong> hinterlegt. Hier durchfÃ¼hren und Summenscore Ã¼bertragen </p>

  AusfÃ¼hrliches Protokoll hier: <a href="BBS_Protokoll.pdf" target="_blank">BBS Protokoll (PDF)</a>

  <button type="button" id="toggleBtn" onclick="toggleForm()">ðŸ‘‰ Zur Kurzversion (7 Items) wechseln</button>

  <form id="bbsForm">
    <div id="questions"></div>
    <button type="button" onclick="calculateBBS()">âœ… Score berechnen</button>
    <div id="scoreDisplay"></div>

    <div id="normBlock">
      <label for="age">Alter der getesteten Person:</label>
      <input type="number" id="age" value="70" min="0" max="120" />
      <button type="button" id="normToggleBtn" onclick="toggleNorm()">ðŸ“Š Normwerte / Cut-Offs anzeigen</button>
    </div>

    <button type="button" onclick="generatePDF()">ðŸ“„ PDF erstellen</button>
  </form>

  <div id="result"></div>
  <div id="normInfo"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const fullQuestions = [
      { text: "Vom Sitzen zum Stehen", options: [
        "4 â€“ kann aufstehen ohne die HÃ¤nde einzusetzen und sich selbststÃ¤ndig stabilisieren",
        "3 â€“ kann selbststÃ¤ndig mit Einsatz der HÃ¤nde aufstehen",
        "2 â€“ kann nach einigen Versuchen mit Einsatz der HÃ¤nde aufstehen",
        "1 â€“ braucht minimale Hilfe zum Aufstehen oder zum Stabilisieren",
        "0 â€“ braucht mÃ¤ÃŸige bis maximale Hilfe um aufzustehen"
      ]},
      { text: "Stehen ohne UnterstÃ¼tzung", options: [
        "4 â€“ kann zwei Minuten sicher stehen",
        "3 â€“ kann zwei Minuten unter Supervision stehen",
        "2 â€“ kann 30 Sek. ohne UnterstÃ¼tzung stehen",
        "1 â€“ braucht einige Versuche, um 30 Sekunden ohne UnterstÃ¼tzung zu stehen",
        "0 â€“ kann nicht ohne UnterstÃ¼tzung 30 Sekunden stehen"
      ]},
      { text: "Sitzen ohne RÃ¼ckenlehne", options: [
        "4 â€“ kann sicher und stabil zwei Minuten sitzen",
        "3 â€“ kann zwei Minuten unter Supervision sitzen",
        "2 â€“ kann 30 Sekunden sitzen",
        "1 â€“ kann 10 Sekunden sitzen",
        "0 â€“ kann nicht ohne UnterstÃ¼tzung 10 Sekunden sitzen"
      ]},
      { text: "Vom Stehen zum Sitzen", options: [
        "4 â€“ setzt sich sicher mit minimalem Einsatz der HÃ¤nde hin",
        "3 â€“ kontrolliert das Hinsetzen mit den HÃ¤nden",
        "2 â€“ berÃ¼hrt mit RÃ¼ckseite der Beine den Stuhl, um das Hinsetzen zu kontrollieren",
        "1 â€“ setzt sich selbstÃ¤ndig aber unkontrolliert hin",
        "0 â€“ braucht Hilfe um sich hinzusetzen"
      ]},
      { text: "Transfer", options: [
        "4 â€“ sicher mit minimalem Einsatz der HÃ¤nde",
        "3 â€“ sicher, aber mit Einsatz der HÃ¤nde",
        "2 â€“ mit Anweisung und/oder Supervision",
        "1 â€“ mit Hilfe einer Person",
        "0 â€“ mit zwei Personen oder stÃ¤ndiger UnterstÃ¼tzung"
      ]},
      { text: "Stehen mit geschlossenen Augen", options: [
        "4 â€“ zehn Sekunden sicher",
        "3 â€“ zehn Sekunden unter Supervision",
        "2 â€“ drei Sekunden",
        "1 â€“ steht stabil, aber nicht mit geschlossenen Augen",
        "0 â€“ braucht Hilfe"
      ]},
      { text: "Stehen mit FÃ¼ÃŸen zusammen", options: [
        "4 â€“ 1 Minute sicher",
        "3 â€“ 1 Minute unter Supervision",
        "2 â€“ 30 Sekunden",
        "1 â€“ 15 Sekunden mit Hilfe",
        "0 â€“ nicht mÃ¶glich"
      ]},
      { text: "Nach vorne greifen", options: [
        "4 â€“ mehr als 25 cm",
        "3 â€“ mehr als 12 cm",
        "2 â€“ mehr als 5 cm",
        "1 â€“ weniger als 5 cm",
        "0 â€“ Gleichgewichtsverlust, Hilfe nÃ¶tig"
      ]},
      { text: "Gegenstand vom Boden aufheben", options: [
        "4 â€“ sicher",
        "3 â€“ mit Ãœberwachung",
        "2 â€“ mit Hilfe oder anderer Technik",
        "1 â€“ nur mit UnterstÃ¼tzung",
        "0 â€“ nicht mÃ¶glich, Gleichgewichtsverlust"
      ]},
      { text: "Umdrehen Ã¼ber Schulter", options: [
        "4 â€“ sicher nach beiden Seiten",
        "3 â€“ unter Supervision",
        "2 â€“ nur eine Seite sicher",
        "1 â€“ unsicher",
        "0 â€“ Gleichgewichtsverlust"
      ]},
      { text: "360Â° drehen", options: [
        "4 â€“ sicher in < 4 Sekunden",
        "3 â€“ sicher in > 4 Sekunden",
        "2 â€“ mit vielen Schritten",
        "1 â€“ mit Hilfe",
        "0 â€“ nicht mÃ¶glich"
      ]},
      { text: "Schritt vorwÃ¤rts", options: [
        "4 â€“ sicher und kontrolliert",
        "3 â€“ unter Supervision",
        "2 â€“ leicht unsicher oder leicht gestÃ¼tzt",
        "1 â€“ mit UnterstÃ¼tzung",
        "0 â€“ nicht mÃ¶glich"
      ]},
      { text: "Tandemstand", options: [
        "4 â€“ 30 Sekunden sicher",
        "3 â€“ 30 Sekunden mit Supervision",
        "2 â€“ unter 30 Sekunden",
        "1 â€“ mit Hilfe",
        "0 â€“ nicht mÃ¶glich"
      ]},
      { text: "Einbeinstand", options: [
        "4 â€“ 10 Sekunden sicher",
        "3 â€“ 10 Sekunden mit Supervision",
        "2 â€“ 5 Sekunden",
        "1 â€“ unter 3 Sekunden",
        "0 â€“ nicht mÃ¶glich"
      ]}
    ];

    const shortIndexes = [0, 5, 7, 8, 9, 12, 13];
    let useShort = false;
    let currentScore = null;
    let normVisible = false;

    function toggleForm() {
      useShort = !useShort;
      document.getElementById("toggleBtn").innerText = useShort
        ? "ðŸ” Zur Vollversion (14 Items) wechseln"
        : "ðŸ‘‰ Zur Kurzversion (7 Items) wechseln";
      renderForm();
      document.getElementById("scoreDisplay").innerText = "";
      document.getElementById("result").innerText = "";
      document.getElementById("normInfo").innerText = "";
      document.getElementById("normBlock").style.display = "none";
      normVisible = false;
    }

    function renderForm() {
      const container = document.getElementById("questions");
      container.innerHTML = "";
      const items = useShort ? shortIndexes.map(i => fullQuestions[i]) : fullQuestions;
      items.forEach((q, i) => {
        const fullIndex = useShort ? shortIndexes[i] : i;
        const block = document.createElement("div");
        block.className = "question-block";
        const options = q.options.map((textOpt, idx) =>
          `<option value="${4 - idx}">${textOpt}</option>`).join("");
        block.innerHTML = `
          <div class="question">${fullIndex + 1}. ${q.text}</div>
          <select name="q${fullIndex}" required>
            <option value="" disabled selected>Antwort auswÃ¤hlen</option>
            ${options}
          </select>
        `;
        container.appendChild(block);
      });
    }

    function calculateNorm(age) {
      if (age < 70) return 56;
      return Math.round((56 - ((age - 70) * 0.7)) * 10) / 10;
    }

    function calculateBBS() {
      const items = useShort ? shortIndexes.map(i => fullQuestions[i]) : fullQuestions;
      let total = 0;
      for (let idx = 0; idx < items.length; idx++) {
        const fullIndex = useShort ? shortIndexes[idx] : idx;
        const sel = document.querySelector(`select[name='q${fullIndex}']`);
        if (!sel || sel.value === "") return alert("Bitte alle Fragen beantworten.");
        total += parseInt(sel.value);
      }
      const max = useShort ? 28 : 56;
      currentScore = total;
      document.getElementById("scoreDisplay").innerText = `BBS Gesamtscore: ${total} / ${max}`;
      if (!useShort) document.getElementById("normBlock").style.display = "block";
    }

    function toggleNorm() {
      const normBtn = document.getElementById("normToggleBtn");
      if (!normVisible) {
        const age = parseInt(document.getElementById("age").value);
        const norm = calculateNorm(age);
        document.getElementById("result").innerText = `Erwarteter Normwert (Alter ${age}): ${norm}`;
        document.getElementById("result").innerText = 
  `Erwarteter Normwert (Alter ${age}): ${norm} Punkte\nCut-off fÃ¼r erhÃ¶htes Sturzrisiko: < 45 Punkte. (BBS aber nicht empfohlen zur alleinigen Beurteilung des Sturzrisikos)`;
        document.getElementById("normInfo").innerText =
          "Ein 70-jÃ¤hriger, selbststÃ¤ndig lebender Mensch ohne beeintrÃ¤chtigende Erkrankungen erreicht wahrscheinlich einen Maximalwert von 56 Punkten auf der BBS. Ab dem 1. Lebensjahr nimmt der mittlere Wert um ca. 0,7 Punkte pro Jahr ab und die Streuung der Werte steigt deutlich an.";
        normBtn.innerText = "âŒ Normwerte verbergen";
        normVisible = true;
      } else {
        document.getElementById("result").innerText = "";
        document.getElementById("normInfo").innerText = "";
        normBtn.innerText = "ðŸ“Š Normwerte / Cut-Offs anzeigen";
        normVisible = false;
      }
    }

    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 10;
      const items = useShort ? shortIndexes.map(i => fullQuestions[i]) : fullQuestions;
      let total = 0;

      doc.setFontSize(16);
      doc.text(`BBS ${useShort ? "Kurzversion" : "Vollversion"} â€“ Auswertung`, 10, y);
      y += 10;

      for (let idx = 0; idx < items.length; idx++) {
        const fullIndex = useShort ? shortIndexes[idx] : idx;
        const q = items[idx];
        const sel = document.querySelector(`select[name='q${fullIndex}']`);
        const val = parseInt(sel.value);
        const label = sel.options[sel.selectedIndex].text;
        total += val;
        doc.setFontSize(12);
        doc.text(`${fullIndex + 1}. ${q.text}`, 10, y);
        y += 6;
        doc.text(`Antwort: ${label}`, 10, y);
        y += 10;
        if (y > 270) {
          doc.addPage();
          y = 10;
        }
      }

      const max = useShort ? 28 : 56;
      doc.setFontSize(14);
      doc.text(`Gesamtscore: ${total} / ${max}`, 10, y);
      window.open(doc.output('bloburl'), '_blank');
    }

    renderForm();
  </script>
</body>
</html>
