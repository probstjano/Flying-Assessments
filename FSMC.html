<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FSMC â€“ Fatigue Skala fÃ¼r Motorik und Kognition</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; font-size: 16px; max-width: 700px; }
    h1 { margin-bottom: 0; }
    p { margin-top: 0.2rem; }
    label { display: block; margin: 1rem 0 0.2rem; }
    .question-block { margin-bottom: 1rem; }
    .question { margin-bottom: 0.5rem; font-weight: bold; }
    button { margin-top: 20px; padding: 10px 15px; font-size: 16px; }
    #result { margin-top: 2rem; font-weight: bold; white-space: pre-line; }
    select { width: 100%; padding: 6px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>FSMC â€“ Fatigue Skala fÃ¼r Motorik und Kognition</h1>
  <p>Bitte jede Aussage beantworten. AuswahlmÃ¶glichkeiten:</p>
  <ul>
    <li>1 â€“ Trifft gar nicht zu</li>
    <li>2 â€“ Trifft wenig zu</li>
    <li>3 â€“ Trifft teils zu</li>
    <li>4 â€“ Trifft ziemlich zu</li>
    <li>5 â€“ Trifft vÃ¶llig zu</li>
  </ul>
  <form id="fsmcForm">
    <div id="questions"></div>
    <button type="button" onclick="calculateFSMC()">âœ… Score berechnen</button>
    <button type="button" onclick="generatePDF()">ðŸ“„ PDF erstellen</button>
  </form>
  <div id="result"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const questions = [
      "Wenn ich mich lÃ¤ngere Zeit konzentriere, erschÃ¶pft es mich schneller als andere Menschen in meinem Alter.",
      "Meine Bewegungen werden im Zustand der ErschÃ¶pfung deutlich verlangsamt.",
      "Wegen meiner ErschÃ¶pfungszustÃ¤nde brauche ich lÃ¤nger, um neue Aufgaben zu beginnen oder Entscheidungen zu treffen.",
      "Ich fÃ¼hle mich auch bei leichter kÃ¶rperlicher Anstrengung erschÃ¶pft.",
      "Wenn ich erschÃ¶pft bin, habe ich Schwierigkeiten, mich sprachlich auszudrÃ¼cken.",
      "Wenn ich erschÃ¶pft bin, fÃ¤llt es mir schwer, mich kÃ¶rperlich zu bewegen.",
      "Wegen meiner ErschÃ¶pfungszustÃ¤nde fÃ¤llt es mir heute schwerer, Neues zu lernen als frÃ¼her.",
      "Berufliche Anforderungen lassen mich geistig schneller erschÃ¶pfen als frÃ¼her.",
      "ErschÃ¶pfungszustÃ¤nde spÃ¼re ich besonders stark in meinen Muskeln.",
      "Bei kÃ¶rperlicher Anstrengung Ã¼ber einen lÃ¤ngeren Zeitraum habe ich eher MÃ¼he durchzuhalten als frÃ¼her.",
      "Meine KonzentrationsfÃ¤higkeit nimmt bei Stress betrÃ¤chtlich ab.",
      "Im Zustand der ErschÃ¶pfung bin ich weniger motiviert etwas zu unternehmen, selbst bei Aufgaben, die mit kÃ¶rperlicher Anstrengung verbunden sind.",
      "Mein Denken verlangsamt sich deutlich, wenn ich erschÃ¶pft bin.",
      "Meine Bewegungen werden im Zustand der ErschÃ¶pfung eindeutig langsamer.",
      "Wenn ich erschÃ¶pft bin, habe ich den Eindruck, etwas zu tun, etwas zu wollen, etwas nachdenken oder entscheiden fÃ¤llt mir schwerer.",
      "Im Zustand der ErschÃ¶pfung bin ich entscheidungsschwach und nicht mehr in der Lage, schnell zu handeln.",
      "Im Zustand der ErschÃ¶pfung komme ich mit Bewegungen langsamer voran.",
      "Meine Aufmerksamkeit lÃ¤sst im ErschÃ¶pfungszustand deutlich nach.",
      "Wenn es heiÃŸ ist, fÃ¼hle ich mich hauptsÃ¤chlich kÃ¶rperlich schwach und bewegungslos.",
      "Im Zustand der ErschÃ¶pfung nimmt meine Vergesslichkeit merklich zu."
    ];

    const labels = [
      "Trifft gar nicht zu",
      "Trifft wenig zu",
      "Trifft teils zu",
      "Trifft ziemlich zu",
      "Trifft vÃ¶llig zu"
    ];

    const cognitiveIndexes = [0, 2, 4, 6, 7, 10, 12, 14, 15, 17];
    const motorIndexes = [1, 3, 5, 8, 9, 11, 13, 16, 18, 19];

    const container = document.getElementById("questions");
    questions.forEach((text, i) => {
      const block = document.createElement("div");
      block.className = "question-block";
      const options = labels.map((label, idx) => `<option value="${idx + 1}">${label}</option>`).join("");
      block.innerHTML = `
        <div class="question">${i + 1}. ${text}</div>
        <select name="q${i}" required>
          <option value="" disabled selected>Antwort auswÃ¤hlen</option>
          ${options}
        </select>
      `;
      container.appendChild(block);
    });

    function calculateFSMC() {
      let cognitive = 0, motoric = 0;
      for (let i = 0; i < 20; i++) {
        const val = parseInt(document.querySelector(`select[name='q${i}']`)?.value);
        if (!val) return alert("Bitte alle Fragen beantworten.");
        if (cognitiveIndexes.includes(i)) cognitive += val;
        else if (motorIndexes.includes(i)) motoric += val;
      }
      const total = cognitive + motoric;

      const level = (value, thresholds) => {
        if (value >= thresholds[2]) return "Schwere";
        if (value >= thresholds[1]) return "Mittelgradige";
        if (value >= thresholds[0]) return "Leichte";
        return "Keine";
      };

      document.getElementById("result").innerText =
        `FSMC Gesamt: ${total} (${level(total, [43, 53, 63])} Fatigue)\n` +
        `Kognitive Fatigue: ${cognitive} (${level(cognitive, [22, 28, 34])})\n` +
        `Motorische Fatigue: ${motoric} (${level(motoric, [22, 27, 32])})`;
    }

    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      let doc = new jsPDF();
      let y = 10;

      doc.setFontSize(16);
      doc.text("FSMC â€“ Auswertung", 10, y);
      y += 10;

      let cognitive = 0, motoric = 0;
      questions.forEach((q, i) => {
        const val = parseInt(document.querySelector(`select[name='q${i}']`)?.value);
        if (!val) val = 0;
        if (cognitiveIndexes.includes(i)) cognitive += val;
        else if (motorIndexes.includes(i)) motoric += val;
      });
      const total = cognitive + motoric;

      const level = (value, thresholds) => {
        if (value >= thresholds[2]) return "Schwere";
        if (value >= thresholds[1]) return "Mittelgradige";
        if (value >= thresholds[0]) return "Leichte";
        return "Keine";
      };

      doc.setFontSize(12);
      doc.text(`FSMC Gesamt: ${total} (${level(total, [43, 53, 63])} Fatigue)`, 10, y);
      y += 7;
      doc.text(`Kognitive Fatigue: ${cognitive} (${level(cognitive, [22, 28, 34])})`, 10, y);
      y += 7;
      doc.text(`Motorische Fatigue: ${motoric} (${level(motoric, [22, 27, 32])})`, 10, y);
      y += 10;

      questions.forEach((q, i) => {
        const val = document.querySelector(`select[name='q${i}']`)?.value;
        const label = val ? labels[parseInt(val) - 1] : "-";
        const line = `${i + 1}. [${val ?? "-"}] ${q} â†’ ${label}`;
        doc.text(line, 10, y);
        y += 7;
        if (y > 280) {
          doc.addPage();
          y = 10;
        }
      });

      window.open(doc.output('bloburl'), '_blank');
    }
  </script>
</body>
</html>
