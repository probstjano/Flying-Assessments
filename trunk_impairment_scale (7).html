
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trunk Impairment Scale</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; font-size: 16px; max-width: 800px; }
    .item-block { margin-bottom: 1.5rem; }
    .hidden { display: none; }
    label { font-weight: bold; margin-bottom: 0.3rem; display: block; }
    select { width: 100%; padding: 8px; font-size: 16px; }
    button { padding: 10px 20px; font-size: 16px; margin-top: 20px; }
    #result { margin-top: 2rem; font-weight: bold; white-space: pre-line; }
    .nav-buttons { margin-top: 3rem; }
    .nav-buttons a {
      display: inline-block; margin-right: 10px; padding: 10px 15px;
      background: #eee; border-radius: 8px; text-decoration: none; color: #000;
    }
    .nav-buttons a:hover { background: #ddd; }
  </style>
</head>
<body>
  <h1>Trunk Impairment Scale (TIS)</h1>
  <form id="tisForm">

    <!-- Items will be added dynamically via JavaScript -->

    <div id="form-items"></div>

    <button type="button" onclick="calculateScore()">‚úÖ Gesamtpunktzahl berechnen</button>
  </form>

  <div id="result"></div>

  <div class="nav-buttons">
    <a href="standard.html">‚¨ÖÔ∏è Zur√ºck zu Standard-Assessments</a>
    <a href="index.html">üè† Zur Startseite</a>
  </div>

  <script>
    const items = [
      {
        id: "item1",
        text: "1. Patient h√§lt Ausgangsposition ohne Unterst√ºtzung f√ºr 10 Sekunden",
        options: {
          "": "Bitte w√§hlen",
          "2": "Ja (2 Punkte)",
          "0": "Nein (0 Punkte ‚Äì Test wird beendet)"
        },
        nextIf: "2"
      },
      {
        id: "item2",
        text: "2. Therapeut kreuzt nicht-betroffenes Bein √ºber das hemiplegische Bein",
        options: {
          "": "Bitte w√§hlen",
          "0": "0 ‚Äì F√§llt oder kann Position nicht 10 Sek halten ohne Armunterst√ºtzung",
          "2": "2 ‚Äì H√§lt Position f√ºr 10 Sekunden"
        }
      },
      {
        id: "item3",
        text: "3. Patient kreuzt selbst nicht-betroffenes Bein √ºber das hemiplegische Bein",
        options: {
          "": "Bitte w√§hlen",
          "0": "0 ‚Äì F√§llt",
          "1": "1 ‚Äì Kann ohne Armhilfe nicht kreuzen",
          "2": "2 ‚Äì Kreuzt, aber mit Rumpfverschiebung >10‚ÄØcm oder Handhilfe",
          "3": "3 ‚Äì Kreuzt ohne Rumpfverschiebung oder Hilfe"
        }
      },
      {
        id: "item4",
        text: "4. Patient ber√ºhrt mit hemiplegischem Ellbogen Bett/Tisch und kehrt in Ausgangsposition zur√ºck",
        options: {
          "": "Bitte w√§hlen",
          "0": "0 ‚Äì F√§llt, braucht Hilfe oder kein Kontakt",
          "1": "1 ‚Äì Ber√ºhrt aktiv ohne Hilfe"
        },
        nextIf: "1"
      },
      {
        id: "item5",
        text: "5. Wiederholung von Item 4 (Bewegungsmuster)",
        options: {
          "": "Bitte w√§hlen",
          "0": "0 ‚Äì Kein oder falsches Verk√ºrzen/Verl√§ngern",
          "1": "1 ‚Äì Korrektes Verk√ºrzen/Verl√§ngern"
        },
        nextIf: "1"
      },
      {
        id: "item6",
        text: "6. Wiederholung von Item 4 (Kompensation)",
        options: {
          "": "Bitte w√§hlen",
          "0": "0 ‚Äì Kompensation durch obere Extremit√§ten, H√ºften, Knie oder F√º√üe",
          "1": "1 ‚Äì Bewegung ohne Kompensation"
        }
      }
    ];

    let scores = {};

    function createItem(item, hidden = false) {
      const block = document.createElement("div");
      block.className = "item-block" + (hidden ? " hidden" : "");
      block.id = item.id + "-block";

      const label = document.createElement("label");
      label.innerText = item.text;

      const select = document.createElement("select");
      select.id = item.id;
      select.onchange = () => onChange(item);

      for (const val in item.options) {
        const opt = document.createElement("option");
        opt.value = val;
        opt.text = item.options[val];
        select.appendChild(opt);
      }

      block.appendChild(label);
      block.appendChild(select);
      document.getElementById("form-items").appendChild(block);
    }

    function onChange(item) {
      const value = document.getElementById(item.id).value;

      // Sonderfall: Item 1 entscheidet √ºber Testabbruch
      if (item.id === "item1" && value === "0") {
        document.getElementById("result").innerText = "Test beendet ‚Äì Item 1 negativ. Gesamtpunktzahl: 0";
        document.querySelectorAll(".item-block").forEach(block => {
          if (block.id !== "item1-block") block.classList.add("hidden");
        });
        return;
      }

      // Folgendes Item sichtbar machen, wenn nextIf erf√ºllt ist
      const index = items.findIndex(i => i.id === item.id);
      if (item.nextIf && value === item.nextIf && items[index + 1]) {
        document.getElementById(items[index + 1].id + "-block").classList.remove("hidden");
      }

      // Sonderlogik f√ºr mehrfache Fortsetzung (z.‚ÄØB. Item 4 ‚ûù 5 ‚ûù 6)
      if (!item.nextIf && items[index + 1]) {
        document.getElementById(items[index + 1].id + "-block").classList.remove("hidden");
      }
    }

    function calculateScore() {
      let total = 0;
      for (const item of items) {
        const val = parseInt(document.getElementById(item.id)?.value);
        if (!isNaN(val)) total += val;
      }
      document.getElementById("result").innerText = `Gesamtpunktzahl: ${total}`;
    }

    // Initial render
    window.onload = () => {
      items.forEach((item, i) => createItem(item, i !== 0));
    };
  </script>
</body>
</html>
